# 3. 3계층형 시스템을 살펴보자

# 3계층형 시스템의 구성도

### 웹서버 - AP 서버 - DB 서버

- 논리 구성

OS
httpd 프로세스...

커널

OS
스레드...

커널

OS
공유메모리
DB 프로세스...
커널

- 서버 내부

동일한 구성
CPU, 메모리, NIC/HBA, 디스크

동일한 구성
CPU, 메모리, NIC/HBA, 디스크

동일한 구성
CPU, 메모리, NIC/HBA, 디스크

# 주요 개념 설명

OS를 이해하는데 있어서 필수 개념이라고 할 수 있는 프로세스와 스레드, 커널에 대해 간단한 설명

### 프로세스와 스레드

1. OS상에서 프로세스가 시작되어 사용자 요청을 받을 수 있게 된다.
2. 시작 의뢰가 있으면 커널이 프로세스를 작성한다. 또한 요처어 분량만큼만 메모리 공간을 할당한다.
3. 프로그램은 서버 내부의 디스크상에 설치된다.

프로세스 및 스레드는 프로그램 실행 파일 자체가 아니라 OS상에서 실행되어 어느 정도 독립성을 가지고 동작하는 것이다.

활동하기 위해서 메모리 공간이 필요하며, 커널에 의해 메모리상에 확보된다.(개인공간)

프로세스 : 전용 메모리 공간을 이용해서  동작

스레드 : 다른 스레드와 메모리 공간을 공유하고 있는 운명 공동체

- 비교
    - 프로세스 : 개별 처리 독립성이 높다. But 생성 시 CPU 부하가 높다
    - 스레드 : 생성 시 부하가 낮다. But 메모리 공간을 공간을 공유하기 때문에 의도하지 않은 데이터 읽기/쓰기가 발생할 수 있다.

### OS 커널

OS에서 커널은 심장, 뇌, 척수. OS의 본질. OS의 인프라

뒤에서 무슨 일이 벌어지는지 은폐하면서도 편리한 인터페이스를 제공하는 것!

- 커널의 여섯 가지 역할
1. 시스템 콜 인터페이스 : 프로세스나 스레드로 부터 명령을 받는 인터페이스(키보드, 마우스 입력은 끼어들기로 처리된다)
2. 프로세스 관리 : 가동되고 있는 프로세스 관리와 CPU 이용 우선순위 등을 '스케줄'한다.
3. 메모리 관리 : 서버상의 메모리를 단위 크기(예 4KB)의 블록으로 분할해서 프로세스에 할당한다.
4. 네트워크 스택 : 네트워크를 관리한다.(6장)
5. 파일 시스템 관리
6. 장치 드라이버 : 디스크, NIC, HBA 등의 물리장치와 작업

# 웹 데이터 흐름

### 클라이언트 PC부터 웹서버까지

1. 웹 브라우저가 요청을 발행한다
2. 이름 해석한다
3. 웹 서버가 요청을 접수한다
4. 웹 서버가 정적 콘텐츠인지 동적 콘텐츠 인지 판단한다
5. 필요한 경로로 데이터에 액세스한다.

# 가상화