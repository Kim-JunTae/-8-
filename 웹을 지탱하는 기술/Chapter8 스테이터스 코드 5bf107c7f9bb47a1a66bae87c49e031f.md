# Chapter8 스테이터스 코드

# 01 스테이터스 코드의 중요성

- 클라이언트의 움직임을 좌우하는 중요한 역할을 담당
- 웹 서비스와 웹 API를 설계하는데 있어서 스테이터스 코드를 어떻게 선택하느냐는 중요 → 응답에 잘못된 스테이터스 코드를 할당해 버리면 클라이언트가 혼동하여 시스템 전체의 동작에 지장을 초래

# 02 스테이터스 라인의 복습

- 응답 메시지

**HTTP/1.1 200 OK
// 프로토콜 버전, 스테이터스 코드, 텍스트 구문**
Content-Type: application/xhtml+xml: charset=utf-8

<html xmlns="http://www.w3.org/1999/xhtml">
....
</html>

# 03 스테이터스 코드의 분류와 의미

### 스테이터스 코드 : 3자리 숫자, 첫째 자리의 숫자에 따라 분류

- 클라이언트와 서버 간의 약속을 최소한으로 억제하고 결합을 가능한 한 완화하기 위해서 첫째 자리 숫자에 따라 분류

> 1xx : 처리중

처리가 계속되고 있음, 클라이언트는 그대로 요청을 계속하던지, 서버의 지시에 따라 프로토콜을 업데이트하여 재전송한다

> 2xx : 성공

요청이 성공

> 3xx : 리다이렉트

다른 리소스로의 리다이렉트, 클라이언트는 이 스테이터스 코드를 받았을 때 응답메시지의 Location 헤더를 보고 새로운 리소스로 접속한다

> 4xx : 클라이언트 에러

클라이언트 에러, 원인은 클라이언트 요청에 있다. 에러를 해결하지 않는 한 정상적인 결과를 얻을 수 없기 때문에 같은 요청을 그대로 재전송할 수는 없다

> 5xx : 서버 에러

서버 에러, 원인이 서버에 있다. 서버 측의 원인이 해결되면, 동일한 요청을 재전송해서 정상적인 결과를 얻을 가능성이 있다

# 04 자주 사용되는 스테이터스 코드

### 가장 많이 사용되는 스테이터스 코드 9개

- 200 OK - 요청 성공
- 201 Created - 리소스 작성 성공
- 301 Moved Permanently - 리소스의 항구적인 이동
- 303 See Other - 다른 URI의 참조
- 404 Bad Request - 요청 오류
- 401 Unauthorized - 접근 권한 없음, 인증 실패
- 404 Not Found - 리소스 없음
- 500 Internal Server Error - 서버 내부 에러
- 503 Service Unavailabe - 서비스 정지

# 05 스테이터스 코드와 에러처리

- 4xx계와 5xx계의 스테이터스 코드는 모두 에러를 표현
- 프로그램용 웹 API의 경우에는 클라이언트가 해석할 수 있는 형식으로 에러 메시지를 반환해 주는 것이 좋다!

### 프로토콜에 따른 포맷으로 에러를 반환한다.

- AtomPub을 이용한 웹 API의 경우, 에러 메시지는 Atom으로 반환하는 것이 한 방법

### Accept 헤더에 따른 포맷으로 에러를 반환한다.

- 클라이언트가 Accept 헤더를 전송하고 있는 경우는 그것을 이용해 에러 정보의 표현을 동적으로 변경할 수 있습니다.

```java
//HTML형식으로 반환
Accept: application/xhtml+xml;q=0.9, text/plain;q=0.3
//Atom형식으로 반한
Accept: application/atom+xml;q=0.9, text/plain;q=0.5
```

# 06 스테이터스 코드의 오용

- 바르게 사용하자.

# 07 스테이터스 코드를 의식해서 설계한다

- 개발 중인 웹 서비스나 웹 API에서 에러가 발생했을 때, 어떤 스테이터스 코드를 반환할지 결정하는 것은 아주 중요한 설계 검토사항입니다.

**스테이터스 코드의 구현
- Apache의 경우
- 서블릿의 경우
- Ruby on Rails의 경우**